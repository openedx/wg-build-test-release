<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/Users/sarinacanelake/openedx/edx-platform/docs/references/docstrings/lms/lms.djangoapps.discussion.notification_prefs.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:http="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <section ids="lms-djangoapps-discussion-notification-prefs-package" names="lms.djangoapps.discussion.notification_prefs\ package">
        <title>lms.djangoapps.discussion.notification_prefs package</title>
        <section ids="submodules" names="submodules">
            <title>Submodules</title>
        </section>
        <section ids="module-lms.djangoapps.discussion.notification_prefs.views lms-djangoapps-discussion-notification-prefs-views-module" names="lms.djangoapps.discussion.notification_prefs.views\ module">
            <title>lms.djangoapps.discussion.notification_prefs.views module</title>
            <index entries="['pair',\ 'module;\ lms.djangoapps.discussion.notification_prefs.views',\ 'module-lms.djangoapps.discussion.notification_prefs.views',\ '',\ None]"></index>
            <paragraph>Views to support notification preferences.</paragraph>
            <index entries="['single',\ 'UsernameCipher\ (class\ in\ lms.djangoapps.discussion.notification_prefs.views)',\ 'lms.djangoapps.discussion.notification_prefs.views.UsernameCipher',\ '',\ None]"></index>
            <desc classes="py class" desctype="class" domain="py" no-contents-entry="False" no-index="False" no-index-entry="False" no-typesetting="False" nocontentsentry="False" noindex="False" noindexentry="False" objtype="class">
                <desc_signature _toc_name="UsernameCipher" _toc_parts="lms.djangoapps.discussion.notification_prefs.views UsernameCipher" class="" classes="sig sig-object py" fullname="UsernameCipher" ids="lms.djangoapps.discussion.notification_prefs.views.UsernameCipher" module="lms.djangoapps.discussion.notification_prefs.views"><desc_annotation xml:space="preserve"><desc_sig_keyword classes="k">class</desc_sig_keyword><desc_sig_space classes="w"> </desc_sig_space></desc_annotation><desc_addname classes="sig-prename descclassname" xml:space="preserve">lms.djangoapps.discussion.notification_prefs.views.</desc_addname><desc_name classes="sig-name descname" xml:space="preserve">UsernameCipher</desc_name></desc_signature>
                <desc_content>
                    <paragraph>Bases: <literal classes="xref py py-class">object</literal></paragraph>
                    <paragraph>A transformation of a username to/from an opaque token</paragraph>
                    <paragraph>The purpose of the token is to make one-click unsubscribe links that don’t
                        require the user to log in. To prevent users from unsubscribing other users,
                        we must ensure the token cannot be computed by anyone who has this
                        source code. The token must also be embeddable in a URL.</paragraph>
                    <paragraph>Thus, we take the following steps to encode (and do the inverse to decode):
                        1. Pad the UTF-8 encoding of the username with PKCS#7 padding to match the</paragraph>
                    <block_quote>
                        <paragraph>AES block length</paragraph>
                    </block_quote>
                    <enumerated_list enumtype="arabic" prefix="" start="2" suffix=".">
                        <list_item>
                            <paragraph>Generate a random AES block length initialization vector</paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>Use AES-256 (with a hash of settings.SECRET_KEY as the encryption key)
                                in CBC mode to encrypt the username</paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>Prepend the IV to the encrypted value to allow for initialization of the
                                decryption cipher</paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>base64url encode the result</paragraph>
                        </list_item>
                    </enumerated_list>
                    <index entries="['single',\ 'decrypt()\ (lms.djangoapps.discussion.notification_prefs.views.UsernameCipher\ static\ method)',\ 'lms.djangoapps.discussion.notification_prefs.views.UsernameCipher.decrypt',\ '',\ None]"></index>
                    <desc classes="py method" desctype="method" domain="py" no-contents-entry="False" no-index="False" no-index-entry="False" no-typesetting="False" nocontentsentry="False" noindex="False" noindexentry="False" objtype="method">
                        <desc_signature _toc_name="UsernameCipher.decrypt()" _toc_parts="lms.djangoapps.discussion.notification_prefs.views UsernameCipher decrypt" class="UsernameCipher" classes="sig sig-object py" fullname="UsernameCipher.decrypt" ids="lms.djangoapps.discussion.notification_prefs.views.UsernameCipher.decrypt" module="lms.djangoapps.discussion.notification_prefs.views"><desc_annotation xml:space="preserve"><desc_sig_keyword classes="k">static</desc_sig_keyword><desc_sig_space classes="w"> </desc_sig_space></desc_annotation><desc_name classes="sig-name descname" xml:space="preserve">decrypt</desc_name><desc_parameterlist multi_line_parameter_list="False" multi_line_trailing_comma="True" xml:space="preserve"><desc_parameter xml:space="preserve"><desc_sig_name classes="n">token</desc_sig_name></desc_parameter></desc_parameterlist></desc_signature>
                        <desc_content>
                        </desc_content>
                    </desc>
                    <index entries="['single',\ 'encrypt()\ (lms.djangoapps.discussion.notification_prefs.views.UsernameCipher\ static\ method)',\ 'lms.djangoapps.discussion.notification_prefs.views.UsernameCipher.encrypt',\ '',\ None]"></index>
                    <desc classes="py method" desctype="method" domain="py" no-contents-entry="False" no-index="False" no-index-entry="False" no-typesetting="False" nocontentsentry="False" noindex="False" noindexentry="False" objtype="method">
                        <desc_signature _toc_name="UsernameCipher.encrypt()" _toc_parts="lms.djangoapps.discussion.notification_prefs.views UsernameCipher encrypt" class="UsernameCipher" classes="sig sig-object py" fullname="UsernameCipher.encrypt" ids="lms.djangoapps.discussion.notification_prefs.views.UsernameCipher.encrypt" module="lms.djangoapps.discussion.notification_prefs.views"><desc_annotation xml:space="preserve"><desc_sig_keyword classes="k">static</desc_sig_keyword><desc_sig_space classes="w"> </desc_sig_space></desc_annotation><desc_name classes="sig-name descname" xml:space="preserve">encrypt</desc_name><desc_parameterlist multi_line_parameter_list="False" multi_line_trailing_comma="True" xml:space="preserve"><desc_parameter xml:space="preserve"><desc_sig_name classes="n">username</desc_sig_name></desc_parameter></desc_parameterlist></desc_signature>
                        <desc_content>
                        </desc_content>
                    </desc>
                </desc_content>
            </desc>
            <index entries="['single',\ 'UsernameDecryptionException',\ 'lms.djangoapps.discussion.notification_prefs.views.UsernameDecryptionException',\ '',\ None]"></index>
            <desc classes="py exception" desctype="exception" domain="py" no-contents-entry="False" no-index="False" no-index-entry="False" no-typesetting="False" nocontentsentry="False" noindex="False" noindexentry="False" objtype="exception">
                <desc_signature _toc_name="UsernameDecryptionException" _toc_parts="lms.djangoapps.discussion.notification_prefs.views UsernameDecryptionException" class="" classes="sig sig-object py" fullname="UsernameDecryptionException" ids="lms.djangoapps.discussion.notification_prefs.views.UsernameDecryptionException" module="lms.djangoapps.discussion.notification_prefs.views"><desc_annotation xml:space="preserve"><desc_sig_keyword classes="k">exception</desc_sig_keyword><desc_sig_space classes="w"> </desc_sig_space></desc_annotation><desc_addname classes="sig-prename descclassname" xml:space="preserve">lms.djangoapps.discussion.notification_prefs.views.</desc_addname><desc_name classes="sig-name descname" xml:space="preserve">UsernameDecryptionException</desc_name></desc_signature>
                <desc_content>
                    <paragraph>Bases: <literal classes="xref py py-class">Exception</literal></paragraph>
                </desc_content>
            </desc>
            <index entries="['single',\ 'ajax_disable()\ (in\ module\ lms.djangoapps.discussion.notification_prefs.views)',\ 'lms.djangoapps.discussion.notification_prefs.views.ajax_disable',\ '',\ None]"></index>
            <desc classes="py function" desctype="function" domain="py" no-contents-entry="False" no-index="False" no-index-entry="False" no-typesetting="False" nocontentsentry="False" noindex="False" noindexentry="False" objtype="function">
                <desc_signature _toc_name="ajax_disable()" _toc_parts="lms.djangoapps.discussion.notification_prefs.views ajax_disable" class="" classes="sig sig-object py" fullname="ajax_disable" ids="lms.djangoapps.discussion.notification_prefs.views.ajax_disable" module="lms.djangoapps.discussion.notification_prefs.views"><desc_addname classes="sig-prename descclassname" xml:space="preserve">lms.djangoapps.discussion.notification_prefs.views.</desc_addname><desc_name classes="sig-name descname" xml:space="preserve">ajax_disable</desc_name><desc_parameterlist multi_line_parameter_list="False" multi_line_trailing_comma="True" xml:space="preserve"><desc_parameter xml:space="preserve"><desc_sig_name classes="n">request</desc_sig_name></desc_parameter></desc_parameterlist></desc_signature>
                <desc_content>
                    <paragraph>A view that disables notifications for the authenticated user</paragraph>
                    <paragraph>This view should be invoked by an AJAX POST call. It returns status 204
                        (no content) or an error.</paragraph>
                </desc_content>
            </desc>
            <index entries="['single',\ 'ajax_enable()\ (in\ module\ lms.djangoapps.discussion.notification_prefs.views)',\ 'lms.djangoapps.discussion.notification_prefs.views.ajax_enable',\ '',\ None]"></index>
            <desc classes="py function" desctype="function" domain="py" no-contents-entry="False" no-index="False" no-index-entry="False" no-typesetting="False" nocontentsentry="False" noindex="False" noindexentry="False" objtype="function">
                <desc_signature _toc_name="ajax_enable()" _toc_parts="lms.djangoapps.discussion.notification_prefs.views ajax_enable" class="" classes="sig sig-object py" fullname="ajax_enable" ids="lms.djangoapps.discussion.notification_prefs.views.ajax_enable" module="lms.djangoapps.discussion.notification_prefs.views"><desc_addname classes="sig-prename descclassname" xml:space="preserve">lms.djangoapps.discussion.notification_prefs.views.</desc_addname><desc_name classes="sig-name descname" xml:space="preserve">ajax_enable</desc_name><desc_parameterlist multi_line_parameter_list="False" multi_line_trailing_comma="True" xml:space="preserve"><desc_parameter xml:space="preserve"><desc_sig_name classes="n">request</desc_sig_name></desc_parameter></desc_parameterlist></desc_signature>
                <desc_content>
                    <paragraph>A view that enables notifications for the authenticated user</paragraph>
                    <paragraph>This view should be invoked by an AJAX POST call. It returns status 204
                        (no content) or an error. If notifications were already enabled for this
                        user, this has no effect. Otherwise, a preference is created with the
                        unsubscribe token (an encryption of the username) as the value.username</paragraph>
                </desc_content>
            </desc>
            <index entries="['single',\ 'ajax_status()\ (in\ module\ lms.djangoapps.discussion.notification_prefs.views)',\ 'lms.djangoapps.discussion.notification_prefs.views.ajax_status',\ '',\ None]"></index>
            <desc classes="py function" desctype="function" domain="py" no-contents-entry="False" no-index="False" no-index-entry="False" no-typesetting="False" nocontentsentry="False" noindex="False" noindexentry="False" objtype="function">
                <desc_signature _toc_name="ajax_status()" _toc_parts="lms.djangoapps.discussion.notification_prefs.views ajax_status" class="" classes="sig sig-object py" fullname="ajax_status" ids="lms.djangoapps.discussion.notification_prefs.views.ajax_status" module="lms.djangoapps.discussion.notification_prefs.views"><desc_addname classes="sig-prename descclassname" xml:space="preserve">lms.djangoapps.discussion.notification_prefs.views.</desc_addname><desc_name classes="sig-name descname" xml:space="preserve">ajax_status</desc_name><desc_parameterlist multi_line_parameter_list="False" multi_line_trailing_comma="True" xml:space="preserve"><desc_parameter xml:space="preserve"><desc_sig_name classes="n">request</desc_sig_name></desc_parameter></desc_parameterlist></desc_signature>
                <desc_content>
                    <paragraph>A view that retrieves notifications status for the authenticated user.</paragraph>
                    <paragraph>This view should be invoked by an AJAX GET call. It returns status 200,
                        with a JSON-formatted payload, or an error.</paragraph>
                </desc_content>
            </desc>
            <index entries="['single',\ 'enable_notifications()\ (in\ module\ lms.djangoapps.discussion.notification_prefs.views)',\ 'lms.djangoapps.discussion.notification_prefs.views.enable_notifications',\ '',\ None]"></index>
            <desc classes="py function" desctype="function" domain="py" no-contents-entry="False" no-index="False" no-index-entry="False" no-typesetting="False" nocontentsentry="False" noindex="False" noindexentry="False" objtype="function">
                <desc_signature _toc_name="enable_notifications()" _toc_parts="lms.djangoapps.discussion.notification_prefs.views enable_notifications" class="" classes="sig sig-object py" fullname="enable_notifications" ids="lms.djangoapps.discussion.notification_prefs.views.enable_notifications" module="lms.djangoapps.discussion.notification_prefs.views"><desc_addname classes="sig-prename descclassname" xml:space="preserve">lms.djangoapps.discussion.notification_prefs.views.</desc_addname><desc_name classes="sig-name descname" xml:space="preserve">enable_notifications</desc_name><desc_parameterlist multi_line_parameter_list="False" multi_line_trailing_comma="True" xml:space="preserve"><desc_parameter xml:space="preserve"><desc_sig_name classes="n">user</desc_sig_name></desc_parameter></desc_parameterlist></desc_signature>
                <desc_content>
                    <paragraph>Enable notifications for a user.
                        Currently only used for daily forum digests.</paragraph>
                </desc_content>
            </desc>
            <index entries="['single',\ 'set_subscription()\ (in\ module\ lms.djangoapps.discussion.notification_prefs.views)',\ 'lms.djangoapps.discussion.notification_prefs.views.set_subscription',\ '',\ None]"></index>
            <desc classes="py function" desctype="function" domain="py" no-contents-entry="False" no-index="False" no-index-entry="False" no-typesetting="False" nocontentsentry="False" noindex="False" noindexentry="False" objtype="function">
                <desc_signature _toc_name="set_subscription()" _toc_parts="lms.djangoapps.discussion.notification_prefs.views set_subscription" class="" classes="sig sig-object py" fullname="set_subscription" ids="lms.djangoapps.discussion.notification_prefs.views.set_subscription" module="lms.djangoapps.discussion.notification_prefs.views"><desc_addname classes="sig-prename descclassname" xml:space="preserve">lms.djangoapps.discussion.notification_prefs.views.</desc_addname><desc_name classes="sig-name descname" xml:space="preserve">set_subscription</desc_name><desc_parameterlist multi_line_parameter_list="False" multi_line_trailing_comma="True" xml:space="preserve"><desc_parameter xml:space="preserve"><desc_sig_name classes="n">request</desc_sig_name></desc_parameter><desc_parameter xml:space="preserve"><desc_sig_name classes="n">token</desc_sig_name></desc_parameter><desc_parameter xml:space="preserve"><desc_sig_name classes="n">subscribe</desc_sig_name></desc_parameter></desc_parameterlist></desc_signature>
                <desc_content>
                    <paragraph>A view that disables or re-enables notifications for a user who may not be authenticated</paragraph>
                    <paragraph>This view is meant to be the target of an unsubscribe link. The request
                        must be a GET, and the <title_reference>token</title_reference> parameter must decrypt to a valid username.
                        The subscribe flag feature controls whether the view subscribes or unsubscribes the user, with subscribe=True
                        used to “undo” accidentally clicking on the unsubscribe link</paragraph>
                    <paragraph>A 405 will be returned if the request method is not GET. A 404 will be
                        returned if the token parameter does not decrypt to a valid username. On
                        success, the response will contain a page indicating success.</paragraph>
                </desc_content>
            </desc>
        </section>
        <section ids="module-lms.djangoapps.discussion.notification_prefs module-contents" names="module\ contents">
            <title>Module contents</title>
            <index entries="['pair',\ 'module;\ lms.djangoapps.discussion.notification_prefs',\ 'module-lms.djangoapps.discussion.notification_prefs',\ '',\ None]"></index>
        </section>
    </section>
</document>
