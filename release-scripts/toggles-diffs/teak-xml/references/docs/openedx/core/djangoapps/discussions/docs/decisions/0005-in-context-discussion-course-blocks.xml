<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/Users/sarinacanelake/openedx/edx-platform/docs/references/docs/openedx/core/djangoapps/discussions/docs/decisions/0005-in-context-discussion-course-blocks.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:http="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <section ids="making-linked-in-context-discussions-available-to-mfes" names="making\ linked\ in-context\ discussions\ available\ to\ mfes">
        <title>Making Linked In-Context Discussions Available to MFEs</title>
        <section ids="status" names="status">
            <title>Status</title>
            <paragraph>Proposal</paragraph>
        </section>
        <section ids="context" names="context">
            <title>Context</title>
            <paragraph>In the <reference name="ADR 0004" refuri="./0004-in-context-discussions-linking.rst">ADR 0004</reference><target ids="adr-0004" names="adr\ 0004" refuri="./0004-in-context-discussions-linking.rst"></target> we investigated
                how to link a discussion to a unit. We also need some way to make these linked
                discussions available to the frontend so they can display those in-context
                discussions in the correct view.</paragraph>
        </section>
        <section ids="requirements" names="requirements">
            <title>Requirements</title>
            <paragraph>An API to access linked discussions for a Unit.</paragraph>
        </section>
        <section ids="decision" names="decision">
            <title>Decision</title>
            <paragraph>A direct link to the topic that needs to be embedded can be generated
                by edx-platform and provided to MFEs via the course blocks API which is
                already used by the learning MFE. The learning MFE can then directly
                embed this link in an iframe as a sidebar.</paragraph>
            <paragraph>For example, when the discussion link is requested using
                <title_reference>requested_fields=discussions_embed_url</title_reference> it will return roughly the
                following:</paragraph>
            <literal_block force="False" highlight_args="{}" language="JSON" linenos="False" xml:space="preserve">{
    ...
    "block-v1:edX+DemoX+Demo_Course+type@vertical+block@vertical_98cf62510471": {
        "id": "block-v1:edX+DemoX+Demo_Course+type@vertical+block@vertical_98cf62510471",
        "block_id": "vertical_98cf62510471",
        "lms_web_url": "http...",
        "legacy_web_url": "http...",
        "student_view_url": "http...",
        "discussions_embed_url": "http://localhost:2002/discussions/course-v1:edX+DemoX+Demo_Course/topics/zooming-diagrams/"
        "type": "vertical",
        "display_name": "Zooming Diagrams"
    },
    ...
}</literal_block>
            <paragraph>For units that donâ€™t have a linked discussion, no link will be returned.</paragraph>
            <paragraph>The new discussions experience includes a setting called
                <title_reference>discussions_group_at_subsection</title_reference> to group discussions at the subsection
                level instead of the unit level. By default this setting is disabled and
                the sidebar next to a unit will only show threads from that unit.
                However, if this setting is enabled then the MFE should show threads
                related to all the units from the subsection in the sidebar.</paragraph>
            <paragraph>If this setting is enabled, then the blocks API will return a link for
                the entire subsection. The MFE can accomodate for this in the UI by
                presenting it in a different way if need be.</paragraph>
            <paragraph>E.g.</paragraph>
            <literal_block force="False" highlight_args="{}" language="JSON" linenos="False" xml:space="preserve">{
    ...
    "block-v1:edX+DemoX+Demo_Course+type@vertical+block@vertical_98cf62510471": {
        "id": "block-v1:edX+DemoX+Demo_Course+type@vertical+block@vertical_98cf62510471",
        "block_id": "vertical_98cf62510471",
        "lms_web_url": "http...",
        "legacy_web_url": "http...",
        "student_view_url": "http...",
        "discussions_embed_url": "http://localhost:2002/discussions/course-v1:edX+DemoX+Demo_Course/category/lesson-2-lets-get-interactive/"
        "type": "vertical",
        "display_name": "Zooming Diagrams"
    },
    ...
}</literal_block>
        </section>
    </section>
</document>
