<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/Users/sarinacanelake/static-clones/edx-platform/docs/decisions/0018-standarize-django-po-files.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:http="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <section ids="standardize-django-po-and-djangojs-po-files" names="standardize\ django.po\ and\ djangojs.po\ files">
        <title>Standardize <literal>django.po</literal> and <literal>djangojs.po</literal> files</title>
        <section ids="status" names="status">
            <title>Status</title>
            <paragraph>Accepted</paragraph>
        </section>
        <section ids="context" names="context">
            <title>Context</title>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>The edx-platform splits its translations into <literal>mako-studio.po</literal>,
                        <literal>django-partial.po</literal>, and 9 other files.  This was done with the
                        intention of supporting more languages in the LMS than in
                        the CMS (Studio).</paragraph>
                </list_item>
                <list_item>
                    <paragraph>The edx-platform uses the <literal>i18n_tools segment</literal> to split the <literal>django.po</literal>
                        and <literal>djangojs.po</literal> files into smaller files. This is done with the goal of
                        making it easier for translators to translate the files.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>When pulling from Transifex or cutting a new release, the translations are
                        bundled into 2 files (<literal>django.po</literal> and <literal>djangojs.po</literal>).</paragraph>
                </list_item>
                <list_item>
                    <paragraph>The <reference name="FC-0012 project" refuri="https://openedx.atlassian.net/l/cp/XGS0iCcQ">FC-0012 project</reference><target ids="fc-0012-project" names="fc-0012\ project" refuri="https://openedx.atlassian.net/l/cp/XGS0iCcQ"></target>
                        which implements <reference name="Translation Infrastructure update OEP-58" refuri="https://open-edx-proposals.readthedocs.io/en/latest/architectural-decisions/oep-0058-arch-translations-management.html#specification">Translation Infrastructure update OEP-58</reference>
                        is in progress. Upon completion, all translation files will live in
                        the new <reference name="openedx-translations Transifex project" refuri="https://app.transifex.com/open-edx/openedx-translations/">openedx-translations Transifex project</reference>.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Consequently, repositories like <literal>edx-platform</literal> will pull translations via
                        <reference name="openedx-atlas" refuri="https://github.com/openedx/openedx-atlas/">openedx-atlas</reference> command line tool as described in the <reference name="OEP-58" refuri="https://open-edx-proposals.readthedocs.io/en/latest/architectural-decisions/oep-0058-arch-translations-management.html#specification">OEP-58</reference> proposal.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Several special steps would be needed to for the
                        <reference name="extract-translation-source-files.yml" refuri="https://github.com/openedx/openedx-translations/blob/2566e0c9a30d033e5dd8d05d4c12601c8e37b4ef/.github/workflows/extract-translation-source-files.yml">extract-translation-source-files.yml</reference> GitHub workflow in
                        the <reference name="openedx-translations GitHub repository" refuri="https://github.com/openedx/openedx-translations">openedx-translations GitHub repository</reference>
                        to extract the files from the <literal>edx-platform</literal> repo.
                        This seems redundant and and it should be possible to simplify the process.</paragraph>
                </list_item>
            </bullet_list>
        </section>
        <section ids="decision-only-use-two-files-for-edx-platform-translations-django-po-and-djangojs-po" names="decision:\ only\ use\ two\ files\ for\ edx-platform\ translations\ (django.po\ and\ djangojs.po)">
            <title>Decision: Only use two files for edx-platform translations (<literal>django.po</literal> and <literal>djangojs.po</literal>)</title>
            <paragraph>edX Platform will push only two files (<literal>django.po</literal> and
                <literal>djangojs.</literal>) to the <reference name="openedx-translations Transifex project" refuri="https://app.transifex.com/open-edx/openedx-translations/">openedx-translations Transifex project</reference>.</paragraph>
        </section>
        <section ids="consequences" names="consequences">
            <title>Consequences</title>
            <paragraph>Pros:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>Translators will need to locate only two resources for the <literal>edx-platform</literal>
                        repo as opposed to 11 resources.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Simplify the <literal>edx-platform</literal> translation extraction scripts in the
                        <reference name="extract-translation-source-files.yml" refuri="https://github.com/openedx/openedx-translations/blob/2566e0c9a30d033e5dd8d05d4c12601c8e37b4ef/.github/workflows/extract-translation-source-files.yml">extract-translation-source-files.yml</reference> GitHub workflow.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>The release cut process will be simplified as well by removing the
                        translation merger step altogether.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Translators will need one workflow for both latest (master) and named
                        releases for the <literal>edx-platform</literal> repo.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Simplifies the work of both the Build Test Release and Transifex working groups.</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>Cons:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>It will be harder for translators to focus on learner-facing text and de-prioritize
                        educator-facing text.</paragraph>
                </list_item>
            </bullet_list>
        </section>
        <section ids="rejected-alternatives" names="rejected\ alternatives">
            <title>Rejected Alternatives</title>
            <section ids="combine-into-four-files" names="combine\ into\ four\ files">
                <title>Combine into four files</title>
                <paragraph>This option tries to keep the original idea of splitting to allow translators
                    to focus on learner-facing text and de-prioritize educator-facing text.</paragraph>
                <paragraph>The four files will be <literal>platform.po</literal>, <literal>platform-js.po</literal>, <literal>studio.po</literal>
                    and <literal>studio-js.po</literal>.</paragraph>
                <paragraph>It will not concern the translators with the technical split
                    of the files into: <literal>wiki.po</literal>, <literal>mako.po</literal>, and <literal>django-partial.po</literal>, etc.</paragraph>
                <paragraph>In this option we’ll create two new configuration files
                    <literal>config.extract-oep58.yaml</literal> and <literal>config.pull-oep58.yaml</literal> to combine the
                    pofiles into the four files and then combine them into two files respectively:</paragraph>
                <literal_block force="False" highlight_args="{}" language="yaml" linenos="False" xml:space="preserve"># config.extract-oep58.yaml
# This file is used by the ``make extract_translations`` when
# the OPENEDX_COMBINE_FILES environment variable is enabled.
generate_merge:
    platform.po:
        - django-partial.po
        - mako.po
        - wiki.po
        - edx_proctoring_proctortrack.po
    platform-js.po:
        - djangojs-partial.po
        - djangojs-account-settings-view.po
        - underscore.po
    studio.po:
        - django-studio.po
        - mako-studio.po
    studio-js.po:
        - djangojs-studio.po
        - underscore-studio.po</literal_block>
                <paragraph>A corresponding <literal>Makefile</literal> change is needed:</paragraph>
                <literal_block force="False" highlight_args="{}" language="make" linenos="False" xml:space="preserve">extract_translations: ## extract localizable strings from sources
    i18n_tool extract -v
    if [ -z "$$OPENEDX_COMBINE_FILES" ]; then \
        i18n_tool generate --config=config.extract-oep58.yaml --verbose 1;
    fi</literal_block>
                <paragraph>The other file would be ran after <literal>make pull_translations</literal> which will
                    be used to make the final <literal>django.po</literal> and <literal>djangojs.po</literal> files that are
                    usable by Django:</paragraph>
                <literal_block force="False" highlight_args="{}" language="yaml" linenos="False" xml:space="preserve"># config.pull-oep58.yaml
# This file is used by the ``make pull_translations`` when
# the OPENEDX_ATLAS_PULL environment variable is enabled.
generate_merge:
    django.po:
        - platform.po
        - studio.po
    djangojs.po:
        - platform-js.po
        - studio-js.po


pull_translations: ## extract localizable strings from sources
    if [ -z "$$OPENEDX_ATLAS_PULL" ]; then \
        atlas pull translations/edx-platform/conf/locale
        i18n_tool --config=config.pull-oep58.yaml generate --verbose 1;
    fi</literal_block>
                <paragraph>This option involves multiple merge and split steps which adds complexity
                    for developers. Based on the <reference name="feedback in the decision pull request" refuri="https://github.com/openedx/edx-platform/pull/32994#issuecomment-1677390405">feedback in the decision pull request</reference>,
                    splitting the resources was a lesser used feature in the Open edX community.
                    Therefore, this option is rejected because the added complexity of this
                    option isn’t justified.</paragraph>
                <target ids="extract-translation-source-files-yml" names="extract-translation-source-files.yml" refuri="https://github.com/openedx/openedx-translations/blob/2566e0c9a30d033e5dd8d05d4c12601c8e37b4ef/.github/workflows/extract-translation-source-files.yml"></target>
                <target ids="openedx-translations-github-repository" names="openedx-translations\ github\ repository" refuri="https://github.com/openedx/openedx-translations"></target>
                <target ids="openedx-translations-transifex-project" names="openedx-translations\ transifex\ project" refuri="https://app.transifex.com/open-edx/openedx-translations/"></target>
                <target ids="oep-58" names="oep-58" refuri="https://open-edx-proposals.readthedocs.io/en/latest/architectural-decisions/oep-0058-arch-translations-management.html#specification"></target>
                <target ids="openedx-atlas" names="openedx-atlas" refuri="https://github.com/openedx/openedx-atlas/"></target>
                <target ids="translation-infrastructure-update-oep-58" names="translation\ infrastructure\ update\ oep-58" refuri="https://open-edx-proposals.readthedocs.io/en/latest/architectural-decisions/oep-0058-arch-translations-management.html#specification"></target>
                <target ids="feedback-in-the-decision-pull-request" names="feedback\ in\ the\ decision\ pull\ request" refuri="https://github.com/openedx/edx-platform/pull/32994#issuecomment-1677390405"></target>
            </section>
        </section>
    </section>
</document>
