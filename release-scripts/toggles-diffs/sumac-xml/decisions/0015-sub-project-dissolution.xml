<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/Users/sarinacanelake/static-clones/edx-platform/docs/decisions/0015-sub-project-dissolution.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:http="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <section ids="dissolution-of-edx-platform-sub-projects" names="dissolution\ of\ edx-platform\ sub-projects">
        <title>Dissolution of edx-platform sub-projects</title>
        <section ids="status" names="status">
            <title>Status</title>
            <paragraph>Accepted</paragraph>
        </section>
        <section ids="context" names="context">
            <title>Context</title>
            <paragraph>A “Python project” is a special folder that contains a “setup.py” file and gets installed using pip; the Python modules within it can be imported relative to said folder. Django projects typically define <emphasis>one</emphasis> Python project; in the case of Open edX, that project is almost always defined at the root of the containing repository. Of course, the project can be organized into hierarchial “Python packages”, which are just folders containing Python code.</paragraph>
            <paragraph>In contrast, edx-platform defined <emphasis>seven</emphasis> Python projects. One project was defined at the repository root, five “sub-projects” were defined in ./common/lib, and one additional sub-project was defined in ./openedx/core/lib/xblock_builtin. This:</paragraph>
            <bullet_list bullet="*">
                <list_item>
                    <paragraph>introduced unneeded complexity into the tooling, testing, and deployment of edx-platform;</paragraph>
                </list_item>
                <list_item>
                    <paragraph>generated developer confusion due to the resulting abnormal import statements;</paragraph>
                </list_item>
                <list_item>
                    <paragraph>created extra surface area for bugs; and</paragraph>
                </list_item>
                <list_item>
                    <paragraph>limited our ability to statically analyze edx-platform.</paragraph>
                </list_item>
            </bullet_list>
        </section>
        <section ids="decision" names="decision">
            <title>Decision</title>
            <paragraph>The sub-projects were dissolved and their contents converted into typical Python packages (that is, folders within Python projects). Where feasible, they were be extracted into other repositories; where not, they were integrated into the edx-platform codebase in the way that seemed to be the least disruptive.</paragraph>
        </section>
        <section ids="consequences" names="consequences">
            <title>Consequences</title>
            <section ids="general-implications" names="general\ implications">
                <title>General Implications</title>
                <bullet_list bullet="*">
                    <list_item>
                        <paragraph>The edx-platform folder ./common/lib will be deleted. Its contents have been moved to various other locations. Some import paths have been changed in order to make this happen, as detailed below.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>There is a new top-level code directory in edx-platform: ./xmodule.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Going forward, given an import in the form <literal>import &lt;BLAH&gt;</literal> in edx-platform, one can assume that either:</paragraph>
                        <bullet_list bullet="*">
                            <list_item>
                                <paragraph>it’s importing from an external library, e.g. <literal>import requests</literal>; or</paragraph>
                            </list_item>
                            <list_item>
                                <paragraph><literal>&lt;BLAH&gt;</literal> represents the full path to the module, relative to the root of edx-platform, e.g. <literal>import xmodule.exception</literal> will import from ./xmodule/exceptions.py.</paragraph>
                            </list_item>
                        </bullet_list>
                    </list_item>
                    <list_item>
                        <paragraph>The Python dependencies lists in edx-platform/requirements no longer point to any code in the local repository. This means that edx-platform Dockerfiles (or other sort of build recipes) no longer need to copy in edx-platform code before installing its requirements, which may have build caching benefits.</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>There are some one-time tactial implications for developers and operators, which we attempted to capture <reference name="in a forum post" refuri="https://discuss.openedx.org/t/breaking-apart-edx-platforms-common-lib-folder/7556#implications-3">in a forum post</reference><target ids="in-a-forum-post" names="in\ a\ forum\ post" refuri="https://discuss.openedx.org/t/breaking-apart-edx-platforms-common-lib-folder/7556#implications-3"></target>.</paragraph>
                    </list_item>
                </bullet_list>
            </section>
            <section ids="detailed-code-changes" names="detailed\ code\ changes">
                <title>Detailed Code Changes</title>
                <section ids="symmath" names="symmath">
                    <title>symmath</title>
                    <bullet_list bullet="*">
                        <list_item>
                            <paragraph>Before:</paragraph>
                            <bullet_list bullet="*">
                                <list_item>
                                    <paragraph>location: edx-platform/common/lib/symmath/symmath</paragraph>
                                </list_item>
                                <list_item>
                                    <paragraph>usage: <literal>import symmath</literal></paragraph>
                                </list_item>
                            </bullet_list>
                        </list_item>
                        <list_item>
                            <paragraph>After:</paragraph>
                            <bullet_list bullet="*">
                                <list_item>
                                    <paragraph>location: openedx-calc/symmath</paragraph>
                                </list_item>
                                <list_item>
                                    <paragraph>usage: <literal>import symmath</literal></paragraph>
                                </list_item>
                            </bullet_list>
                        </list_item>
                        <list_item>
                            <paragraph>PR: <reference refuri="https://github.com/openedx/edx-platform/pull/29869">https://github.com/openedx/edx-platform/pull/29869</reference></paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>Notes: This code thematically relates to openedx-calc repository and was easy to extract from edx-platform. It was important that its import path did not change, though, because instructor-authored code can import symmath, and that code would be very difficult to change across all Open edX instances.</paragraph>
                        </list_item>
                    </bullet_list>
                </section>
                <section ids="safe-lxml" names="safe_lxml">
                    <title>safe_lxml</title>
                    <bullet_list bullet="*">
                        <list_item>
                            <paragraph>Before:</paragraph>
                            <bullet_list bullet="*">
                                <list_item>
                                    <paragraph>location: edx-platform/common/lib/safe_lxml/safe_lxml</paragraph>
                                </list_item>
                                <list_item>
                                    <paragraph>usage: <literal>import safe_lxml</literal></paragraph>
                                </list_item>
                            </bullet_list>
                        </list_item>
                        <list_item>
                            <paragraph>After:</paragraph>
                            <bullet_list bullet="*">
                                <list_item>
                                    <paragraph>location: edx-platform/openedx/core/lib/safe_lxml</paragraph>
                                </list_item>
                                <list_item>
                                    <paragraph>usage: <literal>import openedx.core.lib.safe_lxml</literal></paragraph>
                                </list_item>
                            </bullet_list>
                        </list_item>
                        <list_item>
                            <paragraph>PR: <reference refuri="https://github.com/openedx/edx-platform/pull/25689">https://github.com/openedx/edx-platform/pull/25689</reference></paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>Notes: safe_lxml is very small and specific to edx-platform, so extraction did not make sense. There were very few existing usages of safe_lxml, so changing its import path was not disruptive.</paragraph>
                        </list_item>
                    </bullet_list>
                </section>
                <section ids="sandbox-packages-loncapa-verifiers-eia" names="sandbox-packages\ (loncapa,\ verifiers,\ eia)">
                    <title>sandbox-packages (loncapa, verifiers, eia)</title>
                    <bullet_list bullet="*">
                        <list_item>
                            <paragraph>Before:</paragraph>
                            <bullet_list bullet="*">
                                <list_item>
                                    <paragraph>location: edx-platform/common/lib/sandbox-packages/*</paragraph>
                                </list_item>
                                <list_item>
                                    <paragraph>usage: <literal>import loncapa, verifiers, eia</literal></paragraph>
                                </list_item>
                            </bullet_list>
                        </list_item>
                        <list_item>
                            <paragraph>After:</paragraph>
                            <bullet_list bullet="*">
                                <list_item>
                                    <paragraph>location: codejail-includes</paragraph>
                                </list_item>
                                <list_item>
                                    <paragraph>usage: <literal>import loncapa, verifiers, eia</literal></paragraph>
                                </list_item>
                            </bullet_list>
                        </list_item>
                        <list_item>
                            <paragraph>PR: <reference refuri="https://github.com/openedx/edx-platform/pull/30402">https://github.com/openedx/edx-platform/pull/30402</reference></paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>Notes: Extracting this folder was very easy because they had little-to-no dependence on edx-platform code. Additionally, this change reduces coupling of the “edx-sandbox” (codejail-powered safe execution environment) from edx-platform.</paragraph>
                        </list_item>
                    </bullet_list>
                </section>
                <section ids="xmodule" names="xmodule">
                    <title>xmodule</title>
                    <bullet_list bullet="*">
                        <list_item>
                            <paragraph>Before:</paragraph>
                            <bullet_list bullet="*">
                                <list_item>
                                    <paragraph>location: edx-platform/common/lib/xmodule/xmodule</paragraph>
                                </list_item>
                                <list_item>
                                    <paragraph>usage: <literal>import xmodule</literal></paragraph>
                                </list_item>
                            </bullet_list>
                        </list_item>
                        <list_item>
                            <paragraph>After:</paragraph>
                            <bullet_list bullet="*">
                                <list_item>
                                    <paragraph>location: edx-platform/xmodule</paragraph>
                                </list_item>
                                <list_item>
                                    <paragraph>usage: <literal>import xmodule</literal></paragraph>
                                </list_item>
                            </bullet_list>
                        </list_item>
                        <list_item>
                            <paragraph>PR: <reference refuri="https://github.com/openedx/edx-platform/pull/30394">https://github.com/openedx/edx-platform/pull/30394</reference></paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>Notes: We chose to move this folder to the repository root because:</paragraph>
                            <bullet_list bullet="*">
                                <list_item>
                                    <paragraph>it has many co-dependencies with the rest of edx-platform, so extraction was not an option; and</paragraph>
                                </list_item>
                                <list_item>
                                    <paragraph>moving it to ./xmodule allowed the import path (<literal>import xmodule</literal>) to remain unchanged, which was helpful due to the large number of such imports both inside and outside of edx-platform.</paragraph>
                                </list_item>
                            </bullet_list>
                        </list_item>
                    </bullet_list>
                </section>
                <section ids="capa" names="capa">
                    <title>capa</title>
                    <bullet_list bullet="*">
                        <list_item>
                            <paragraph>Before:</paragraph>
                            <bullet_list bullet="*">
                                <list_item>
                                    <paragraph>location: edx-platform/common/lib/capa/capa</paragraph>
                                </list_item>
                                <list_item>
                                    <paragraph>usage: <literal>import capa</literal></paragraph>
                                </list_item>
                            </bullet_list>
                        </list_item>
                        <list_item>
                            <paragraph>After:</paragraph>
                            <bullet_list bullet="*">
                                <list_item>
                                    <paragraph>location: edx-platform/xmodule/capa</paragraph>
                                </list_item>
                                <list_item>
                                    <paragraph>usage: <literal>import xmodule.capa</literal></paragraph>
                                </list_item>
                            </bullet_list>
                        </list_item>
                        <list_item>
                            <paragraph>PR: <reference refuri="https://github.com/openedx/edx-platform/pull/30403">https://github.com/openedx/edx-platform/pull/30403</reference></paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>Notes: Like xmodule, extracting capa from edx-platform would have been difficult. However, updating its import path was feasible; so, to create avoid creating a sixth top-level package, it was decided to move the code within ./xmodule as a sub-packages. ./xmodule was chosen as the parent package because it contains related code, notably ./xmodule/capa_block.py, which defines the <literal>ProblemBlock</literal> (formerly the <literal>CapaModule</literal>).</paragraph>
                        </list_item>
                    </bullet_list>
                </section>
                <section ids="xblock-discussion" names="xblock_discussion">
                    <title>xblock_discussion</title>
                    <bullet_list bullet="*">
                        <list_item>
                            <paragraph>Before:</paragraph>
                            <bullet_list bullet="*">
                                <list_item>
                                    <paragraph>location: edx-platform/openedx/core/lib/xblock_builtin/xblock_discussion</paragraph>
                                </list_item>
                                <list_item>
                                    <paragraph>usage: <literal>import xblock_discussion</literal></paragraph>
                                </list_item>
                            </bullet_list>
                        </list_item>
                        <list_item>
                            <paragraph>After:</paragraph>
                            <bullet_list bullet="*">
                                <list_item>
                                    <paragraph>location: edx-platform/xmodule/discussion_block.py</paragraph>
                                </list_item>
                                <list_item>
                                    <paragraph>usage: <literal>import xmodule.discussion_block</literal></paragraph>
                                </list_item>
                            </bullet_list>
                        </list_item>
                        <list_item>
                            <paragraph>PR: <reference refuri="https://github.com/openedx/edx-platform/pull/30636">https://github.com/openedx/edx-platform/pull/30636</reference></paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>Notes: This project was essentially a stub that just defined the <literal>DiscussionBlock</literal> class. The block’s actual implementation is still spread throughout edx-platform. Because all other baked-in XBlocks are defined in ./xmodule, it was decided to move the block’s definition there as well.</paragraph>
                        </list_item>
                    </bullet_list>
                </section>
            </section>
        </section>
        <section ids="alternatives-considered" names="alternatives\ considered">
            <title>Alternatives Considered</title>
            <paragraph>No alternatives were considered.</paragraph>
        </section>
        <section ids="further-reading" names="further\ reading">
            <title>Further Reading</title>
            <paragraph>These changes were <reference name="announced on the community forums" refuri="https://discuss.openedx.org/t/breaking-apart-edx-platforms-common-lib-folder/7556">announced on the community forums</reference><target ids="announced-on-the-community-forums" names="announced\ on\ the\ community\ forums" refuri="https://discuss.openedx.org/t/breaking-apart-edx-platforms-common-lib-folder/7556"></target> and <reference name="detailed futher in a public Jira epic" refuri="https://openedx.atlassian.net/browse/BOM-2579">detailed futher in a public Jira epic</reference><target ids="detailed-futher-in-a-public-jira-epic" names="detailed\ futher\ in\ a\ public\ jira\ epic" refuri="https://openedx.atlassian.net/browse/BOM-2579"></target>.</paragraph>
        </section>
    </section>
</document>
