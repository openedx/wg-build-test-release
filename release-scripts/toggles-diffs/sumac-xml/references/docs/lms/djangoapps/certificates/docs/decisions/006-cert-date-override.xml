<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/Users/sarinacanelake/static-clones/edx-platform/docs/references/docs/lms/djangoapps/certificates/docs/decisions/006-cert-date-override.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:http="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <section ids="certificate-date-override" names="certificate\ date\ override">
        <title>Certificate Date Override</title>
        <section ids="status" names="status">
            <title>Status</title>
            <paragraph>Accepted</paragraph>
        </section>
        <section ids="background" names="background">
            <title>Background</title>
            <paragraph>Generally speaking, a learner is awarded a course certificate upon earning a
                passing grade in a course. (Other ADRs go into the specifics of when a
                certificate is earned.) The data backing a course certificate is stored in the
                <literal>GeneratedCertificate</literal> model. The course certificate generally displays an
                “Issued On” date. This date might be the associated course’s
                <literal>certificate_available_date</literal> if set and elapsed; otherwise it will be the
                <literal>GeneratedCertificate</literal> <literal>modified</literal> date.</paragraph>
            <paragraph>However, the <literal>modified</literal> date can be advanced by several backend processing
                systems. This means that a course certificate can display a confusing issue
                date. When this date changes to a date that is significantly distanced from the
                actual date that the learner earned the certificate, it can cause problems for
                the learner if they have an outcome (raise, promotion, acceptance to academic
                program) that is related to when they earned the certificate.</paragraph>
        </section>
        <section ids="decision" names="decision">
            <title>Decision</title>
            <paragraph>We will add a new model to the certificates app called
                <literal>CertificateDateOverride</literal>. This model will be accessed through the Django Admin
                and used to manually override the date on course certificates.</paragraph>
            <paragraph>We are choosing to make a new, separate model and associate it with
                <literal>GeneratedCertificate</literal> (rather than adding new fields to <literal>GeneratedCertificate</literal>)
                because we expect the number of certificates that will need to use this feature
                to be very low. We don’t want to add a new field to a potentially very large
                table that may only be used by a small number of records.
                <literal>CertificateDateOverride</literal> will have a <literal>OneToOne</literal> Relationship with
                <literal>GeneratedCertificate</literal>; each certificate should have only one date override, and
                a date override will belong to only one certificate. The new table will have an
                accompanying history table.</paragraph>
            <paragraph>In addition to the date itself, we would like to keep track of some other pieces
                of information around the date: the <literal>user</literal> who made the date override, and the
                <literal>reason</literal> why. While <literal>django-simple-history</literal> is able to provide us with these
                things, we decided to keep this data directly on the <literal>CertificateDateOverride</literal>
                model to be able to surface them more directly in case the record is used in the
                product UI in the future.</paragraph>
            <paragraph>To edit or remove a date override, admin users should return to the relevant
                <literal>CertificateDateOverride</literal> admin page and either edit the date or delete the
                record, respectively. This is a different approach than some analogous models in
                our app, where data is “removed” by toggling an <literal>active</literal> flag. In our case, we
                are comfortable truly deleting the <literal>CertificateDateOverride</literal> objects, and
                comfortable relying on the history table’s record of change.</paragraph>
            <paragraph>The <literal>CertificateDateOverride</literal> will override all other date logic when it comes
                to the date displayed on the certificate. (This includes overriding the
                <literal>certificate_available_date</literal>.) However, the <literal>CertificateDateOverride</literal> will not
                affect the availability or visibility of the certificate.</paragraph>
            <paragraph>Whenever a <literal>CertificateDateOverride</literal> is saved (either for the first time or
                after a change) or deleted, it will trigger the <literal>COURSE_CERT_CHANGED</literal> signal.
                The date override data (if present) will be included in the post to
                <reference name="Credentials" refuri="https://github.com/openedx/credentials">Credentials</reference> whenever this signal is called. Credentials will save and use
                this data for the Program Record page.</paragraph>
            <target ids="credentials" names="credentials" refuri="https://github.com/openedx/credentials"></target>
        </section>
    </section>
</document>
