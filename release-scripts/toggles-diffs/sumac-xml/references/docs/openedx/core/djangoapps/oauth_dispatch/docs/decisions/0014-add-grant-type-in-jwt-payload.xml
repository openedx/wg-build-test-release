<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/Users/sarinacanelake/static-clones/edx-platform/docs/references/docs/openedx/core/djangoapps/oauth_dispatch/docs/decisions/0014-add-grant-type-in-jwt-payload.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:http="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <section ids="added-grant-type-in-jwt-payload" names="14.\ added\ grant\ type\ in\ jwt\ payload">
        <title>14. Added grant type in JWT payload</title>
        <section ids="status" names="status">
            <title>Status</title>
            <paragraph>Accepted</paragraph>
        </section>
        <section ids="context" names="context">
            <title>Context</title>
            <paragraph>Open edX mobile apps are <reference name="migrating to JWT token" refuri="0013-mobile-migration-to-jwt.rst">migrating to JWT token</reference> authentication.
                As part of the current mobile authentication flow, we exchange an opaque access token for a session.
                This is only allowed for access tokens created with the password grant type.
                However, as we migrate from using the opaque access token to a JWT, we are no longer able to determine the grant type of the JWT.</paragraph>
            <target ids="migrating-to-jwt-token" names="migrating\ to\ jwt\ token" refuri="0013-mobile-migration-to-jwt.rst"></target>
        </section>
        <section ids="decisions" names="decisions">
            <title>Decisions</title>
            <paragraph>A new claim <literal>grant_type</literal> will be added to the payload while creating the JWT.
                The claim <literal>grant_type</literal> will be determined using the grant type information stored for the django-oauth-toolkit (DOT) opaque access token that the JWT was based off of during the mobile flow.
                JWTs created from an access token in mobile flow will have a grant type of <literal>password</literal>, and can be used for the session exchange.</paragraph>
        </section>
        <section ids="consequences" names="consequences">
            <title>Consequences</title>
            <bullet_list bullet="*">
                <list_item>
                    <paragraph>JWT will have an additional claim “grant_type” in its payload, which we can use to take decisions regarding auth exchange.</paragraph>
                </list_item>
            </bullet_list>
        </section>
    </section>
</document>
