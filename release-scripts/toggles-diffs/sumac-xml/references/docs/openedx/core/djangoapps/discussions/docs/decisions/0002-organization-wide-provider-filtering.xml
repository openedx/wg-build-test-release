<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/Users/sarinacanelake/static-clones/edx-platform/docs/references/docs/openedx/core/djangoapps/discussions/docs/decisions/0002-organization-wide-provider-filtering.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:http="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <section ids="allow-organization-wide-filtering-of-discussion-providers" names="allow\ organization-wide\ filtering\ of\ discussion\ providers">
        <title>Allow organization-wide filtering of discussion providers</title>
        <section ids="status" names="status">
            <title>Status</title>
            <paragraph>Proposal</paragraph>
        </section>
        <section ids="context" names="context">
            <title>Context</title>
            <paragraph>As part of the BD-03 initiative (Blended Development, Project 3),
                we want to allow Organizations to filter the list of available
                third-party discussion providers.</paragraph>
            <paragraph>This could be due to a number of motivations, eg:
                - desired experience
                - support levels
                - data sharing</paragraph>
            <paragraph>We would, however, want to allow for manual exceptions.</paragraph>
            <paragraph>This document proposes a new configuration system that allows
                admins to maintain a deny-allow-list to allow filtering of discussions
                providers on a per-organization basis.</paragraph>
        </section>
        <section ids="requirements" names="requirements">
            <title>Requirements</title>
            <paragraph>Given a particular organization, we must be able to remove options
                from the list of available discussions providers during configuration.</paragraph>
        </section>
        <section ids="consideration" names="consideration">
            <title>Consideration</title>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph>Django settings based (remote config, etc.)
                        - pros:</paragraph>
                    <block_quote>
                        <bullet_list bullet="-">
                            <list_item>
                                <paragraph>ease of implmentation</paragraph>
                            </list_item>
                        </bullet_list>
                    </block_quote>
                    <bullet_list bullet="-">
                        <list_item>
                            <paragraph>cons:
                                - overhead in maintenance (even with remote config, it would require</paragraph>
                            <block_quote>
                                <paragraph>an engineer to make a code/config change and pull request</paragraph>
                            </block_quote>
                        </list_item>
                    </bullet_list>
                </list_item>
                <list_item>
                    <paragraph>Database-backed
                        - pros:</paragraph>
                    <block_quote>
                        <bullet_list bullet="-">
                            <list_item>
                                <paragraph>ease of use
                                    - by (django) admins</paragraph>
                            </list_item>
                        </bullet_list>
                    </block_quote>
                    <bullet_list bullet="-">
                        <list_item>
                            <paragraph>cons:
                                - possible schema lock-in</paragraph>
                            <block_quote>
                                <bullet_list bullet="-">
                                    <list_item>
                                        <definition_list>
                                            <definition_list_item>
                                                <term>eg: do we scope it to <title_reference>organizations</title_reference> only?</term>
                                                <definition>
                                                    <paragraph>or do we generalize it enough to use elsewhere?</paragraph>
                                                </definition>
                                            </definition_list_item>
                                        </definition_list>
                                    </list_item>
                                </bullet_list>
                            </block_quote>
                        </list_item>
                    </bullet_list>
                </list_item>
            </bullet_list>
        </section>
        <section ids="decision" names="decision">
            <title>Decision</title>
            <paragraph>We propose to implement this as a Django database-backed model,
                <title_reference>ProviderFilter</title_reference>.</paragraph>
            <paragraph>The underlying model can be represented as:</paragraph>
            <bullet_list bullet="-">
                <list_item>
                    <paragraph><title_reference>allow</title_reference> is a comma-delimited string of providers to allow</paragraph>
                </list_item>
                <list_item>
                    <paragraph><title_reference>deny</title_reference> is a comma-delimited string of providers to deny</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>By extending the <title_reference>StackedConfigurationModel</title_reference>, we gain the flexibility of
                stacking global/site/org/course/run values to not only provide
                organization-wide filtering today, but to arbitrary levels of
                granularity in the future. As this base model already exists in
                <title_reference>edx-platform</title_reference>, integration is low-effort.</paragraph>
        </section>
        <section ids="examples" names="examples">
            <title>Examples</title>
            <paragraph>With this system, we can configure global/site-wide defaults,</paragraph>
            <paragraph>And then override to deny an external provider for an organization:</paragraph>
            <paragraph>Or override to deny _all_ external providers for an organization:</paragraph>
            <paragraph>And grant an exemption to a specific course:</paragraph>
        </section>
        <section ids="logic" names="logic">
            <title>Logic</title>
            <paragraph>By default, all installed providers are available.</paragraph>
            <paragraph>If no database record exists for the organization, the allow and deny
                lists are considered empty, ie, there are no restrictions.</paragraph>
            <paragraph>If there are any items in the allow list, all _other_ providers will be
                removed from the available list.</paragraph>
            <paragraph>If there are any items in the deny list, _these_ providers will be
                removed from the available list.</paragraph>
            <paragraph>The order of operations between the deny and allow should be
                interchangeable.</paragraph>
        </section>
    </section>
</document>
