<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/Users/sarinacanelake/static-clones/edx-platform/docs/references/docs/openedx/core/djangoapps/waffle_utils/docs/decisions/0002-waffle-utils-extraction.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:http="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <section ids="waffle-utils-extraction" names="waffle\ utils\ extraction">
        <title>Waffle Utils Extraction</title>
        <section ids="status" names="status">
            <title>Status</title>
            <paragraph>Accepted</paragraph>
        </section>
        <section ids="context" names="context">
            <title>Context</title>
            <paragraph>The waffle utilities in this app were created in edx-platform, but are generally useful across IDAs.</paragraph>
        </section>
        <section ids="decision" names="decision">
            <title>Decision</title>
            <paragraph>These utilities will be be moved to <reference name="edx/edx-toggles" refuri="https://github.com/openedx/edx-toggles">edx/edx-toggles</reference> so that they can be used by other IDAs. Additionally, the shared library will use the module name <literal>toggles</literal>, rather than <literal>waffle_utils</literal>, so it can more generally include non-waffle based toggle utilities as well.</paragraph>
            <target ids="edx-edx-toggles" names="edx/edx-toggles" refuri="https://github.com/openedx/edx-toggles"></target>
        </section>
        <section ids="consequences" names="consequences">
            <title>Consequences</title>
            <bullet_list bullet="*">
                <list_item>
                    <paragraph>Rollout plan required to deprecate and update class references.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>See ADR 0003-leave-course-waffle-flag for the decision to leave the CourseWaffleFlag behind.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>See ADR 0004-waffle-util-namespacing for decision to change namespacing implementation before extraction.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>The toggle state endpoint, which is meant to be a Django Plugin, could be extracted as a separate step. This requires some additional work:</paragraph>
                    <bullet_list bullet="*">
                        <list_item>
                            <paragraph>Finishing out work around Django Plugin capabilities in edx-django-utils.</paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>Adding ability to document CourseWaffleFlag from edx-platform. Note: we may lose the ability to find course override data for toggles no longer in use, by looping through the entire model, unless we add a hook for this from the edx-toggles version.</paragraph>
                        </list_item>
                    </bullet_list>
                </list_item>
                <list_item>
                    <paragraph>The helper <reference name="get_instance_module_name" refuri="https://github.com/openedx/edx-platform/blob/a8c3413a32510dc45301d0c462bf706a5f7ba487/openedx/core/djangoapps/waffle_utils/__init__.py#L521">get_instance_module_name</reference> should probably move to <reference name="edx_django_utils/monitoring/code_owner" refuri="https://github.com/openedx/edx-django-utils/tree/master/edx_django_utils/monitoring/code_owner">edx_django_utils/monitoring/code_owner</reference>. It could be considered hacky, but is quite useful. It needs to work whether the class definition is in a library or an IDA, and whether the instance declaration is in a library or an IDA.</paragraph>
                </list_item>
            </bullet_list>
            <target ids="get-instance-module-name" names="get_instance_module_name" refuri="https://github.com/openedx/edx-platform/blob/a8c3413a32510dc45301d0c462bf706a5f7ba487/openedx/core/djangoapps/waffle_utils/__init__.py#L521"></target>
            <target ids="edx-django-utils-monitoring-code-owner" names="edx_django_utils/monitoring/code_owner" refuri="https://github.com/openedx/edx-django-utils/tree/master/edx_django_utils/monitoring/code_owner"></target>
        </section>
    </section>
</document>
