<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/Users/sarinacanelake/static-clones/edx-platform/docs/references/docs/openedx/core/djangoapps/waffle_utils/docs/decisions/0001-refactor-waffle-flag-default.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:http="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <section ids="refactor-waffle-flag-default" names="refactor\ waffle\ flag\ default">
        <title>Refactor Waffle Flag Default</title>
        <section ids="status" names="status">
            <title>Status</title>
            <paragraph>Accepted</paragraph>
        </section>
        <section ids="context" names="context">
            <title>Context</title>
            <paragraph>While working on the toggle reports, it became clear that the value for WaffleFlags (and derivatives like CourseWaffleFlag) in all environments was difficult to determine, and difficult to reason about.</paragraph>
            <paragraph>By default, the original waffle flag values are False, unless a record is created to turn it on under certain circumstances. Having the ability to make the default True in code was confusing when looking in Admin and trying to determine the current value of the flag. It also would have been complex to have the report have to investigate code to try to determine this value.</paragraph>
        </section>
        <section ids="decision" names="decision">
            <title>Decision</title>
            <bullet_list bullet="*">
                <list_item>
                    <paragraph>Retire the <literal>flag_undefined_default</literal> argument for WaffleFlag and CourseWaffleFlag that allowed you to change the default to True in code.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Do not introduce any new ability to adjust the default in code.</paragraph>
                </list_item>
                <list_item>
                    <paragraph>Teams can use any of the following alternatives instead:</paragraph>
                    <bullet_list bullet="*">
                        <list_item>
                            <paragraph>The flag can simply be removed at this time if it was meant to be temporary.</paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>The flag could be replaced with a Django Setting, if the features of a flag are not needed for the permanent toggle.</paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>You could add a migration that adds an active (True) waffle flag database record if a record doesnâ€™t already exist.</paragraph>
                        </list_item>
                        <list_item>
                            <paragraph>You could introduce and replace an <emphasis>enable</emphasis> flag with a new <emphasis>disable</emphasis> flag. This might be useful when a permanent toggle is desired that requires features of a waffle flag, and where disabling would now be the exceptional case, since the default would be inactive (False).</paragraph>
                        </list_item>
                    </bullet_list>
                </list_item>
            </bullet_list>
        </section>
        <section ids="consequences" names="consequences">
            <title>Consequences</title>
            <bullet_list bullet="*">
                <list_item>
                    <paragraph>We will need to implement one of the alternate solutions for each flag currently using <literal>flag_undefined_default=True</literal>, and then finally remove the deprecated <literal>flag_undefined_default</literal> argument.</paragraph>
                </list_item>
            </bullet_list>
            <paragraph>UPDATE: This work has been completed and <literal>flag_undefined_default</literal> has been removed.</paragraph>
        </section>
        <section ids="rejected-alternatives" names="rejected\ alternatives">
            <title>Rejected Alternatives</title>
            <paragraph>We are clearly rejecting the <literal>flag_undefined_default</literal> argument.</paragraph>
            <paragraph>We are also rejecting any other alternative that would separate this default from the normal usage of the waffle flag record.</paragraph>
        </section>
    </section>
</document>
