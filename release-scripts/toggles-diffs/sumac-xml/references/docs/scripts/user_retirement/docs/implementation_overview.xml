<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE document PUBLIC "+//IDN docutils.sourceforge.net//DTD Docutils Generic//EN//XML" "http://docutils.sourceforge.net/docs/ref/docutils.dtd">
<!-- Generated by Docutils 0.21.2 -->
<document source="/Users/sarinacanelake/static-clones/edx-platform/docs/references/docs/scripts/user_retirement/docs/implementation_overview.rst" translation_progress="{'total': 0, 'translated': 0}" xmlns:c="https://www.sphinx-doc.org/" xmlns:changeset="https://www.sphinx-doc.org/" xmlns:citation="https://www.sphinx-doc.org/" xmlns:cpp="https://www.sphinx-doc.org/" xmlns:http="https://www.sphinx-doc.org/" xmlns:index="https://www.sphinx-doc.org/" xmlns:js="https://www.sphinx-doc.org/" xmlns:math="https://www.sphinx-doc.org/" xmlns:py="https://www.sphinx-doc.org/" xmlns:rst="https://www.sphinx-doc.org/" xmlns:std="https://www.sphinx-doc.org/">
    <target refid="implmentation"></target>
    <section ids="implementation-overview implmentation" names="implementation\ overview implmentation">
        <title>Implementation Overview</title>
        <paragraph>In the Open edX platform, the user experience is enabled by several
            services, such as LMS, Studio, ecommerce, credentials, discovery, and more.
            Personally Identifiable Identification (PII) about a user can exist in many of
            these services. As a consequence, to remove a user’s PII, you must be able
            to request each service containing PII to remove, delete, or unlink the
            data for that user in that service.</paragraph>
        <paragraph>In the user retirement feature, a centralized process (the <emphasis>driver</emphasis> scripts)
            orchestrates all of these requests. For information about how to configure the
            driver scripts, see <reference internal="True" refuri="driver_setup#driver-setup"><inline classes="std std-ref">Setting Up the User Retirement Driver Scripts</inline></reference>.</paragraph>
        <section ids="the-user-retirement-workflow" names="the\ user\ retirement\ workflow">
            <title>The User Retirement Workflow</title>
            <paragraph>The user retirement workflow is a configurable pipeline of building-block
                APIs. These APIs are used to:</paragraph>
            <block_quote>
                <bullet_list bullet="*">
                    <list_item>
                        <paragraph>“Forget” a retired user’s PII</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Prevent a retired user from logging back in</paragraph>
                    </list_item>
                    <list_item>
                        <paragraph>Prevent re-use of the username or email address of a retired user</paragraph>
                    </list_item>
                </bullet_list>
            </block_quote>
            <paragraph>Depending on which third parties a given Open edX instance integrates with,
                the user retirement process may need to call out to external services or to
                generate reports for later processing. Any such reports must subsequently be
                destroyed.</paragraph>
            <paragraph>Configurability and adaptability were design goals from the beginning, so this
                user retirement tooling should be able to accommodate a wide range of Open edX
                sites and custom use cases.</paragraph>
            <paragraph>The workflow is designed to be linear and rerunnable, allowing recovery and
                continuation in cases where a particular stage fails.  Each user who has
                requested retirement will be individually processed through this workflow, so
                multiple users could be in the same state simultaneously.  The LMS is the
                authoritative source of information about the state of each user in the
                retirement process, and the arbiter of state progressions, using the
                <literal>UserRetirementStatus</literal> model and associated APIs.  The LMS also holds a
                table of the states themselves (the <literal>RetirementState</literal> model), rather than
                hard-coding the states.  This was done because we cannot predict all the
                possible states required by all members of the Open edX community.</paragraph>
            <paragraph>This example state diagram outlines the pathways users follow throughout the
                workflow:</paragraph>
            <graphviz align="center" code='digraph retirement_states_example {&#10;   ranksep = "0.3";&#10;&#10;   node[fontname=Courier,fontsize=12,shape=box,group=main]&#10;   { rank = same INIT[style=invis] PENDING }&#10;   INIT -&gt; PENDING;&#10;   "..."[shape=none]&#10;   PENDING -&gt; RETIRING_ENROLLMENTS -&gt; ENROLLMENTS_COMPLETE -&gt; RETIRING_FORUMS -&gt; FORUMS_COMPLETE -&gt; "..." -&gt; COMPLETE;&#10;&#10;   node[group=""];&#10;   RETIRING_ENROLLMENTS -&gt; ERRORED;&#10;   RETIRING_FORUMS -&gt; ERRORED;&#10;   PENDING -&gt; ABORTED;&#10;&#10;   subgraph cluster_terminal_states {&#10;       label = "Terminal States";&#10;       labelloc = b  // put label at bottom&#10;       {rank = same ERRORED COMPLETE ABORTED}&#10;   }&#10;}&#10;' options="{'docname': 'references/docs/scripts/user_retirement/docs/implementation_overview'}">
            </graphviz>
            <paragraph>Unless an error occurs internal to the user retirement tooling, a user’s
                retirement state should always land in one of the terminal states.  At that
                point, either their entry should be cleaned up from the
                <literal>UserRetirementStatus</literal> table or, if the state is <literal>ERRORED</literal>, the
                administrator needs to examine the error and resolve it. For more information,
                see <reference internal="True" refuri="special_cases#recovering-from-errored"><inline classes="std std-ref">Recovering from ERRORED</inline></reference>.</paragraph>
        </section>
        <section ids="the-user-experience" names="the\ user\ experience">
            <title>The User Experience</title>
            <paragraph>From the learner’s perspective, the vast majority of this process is obscured.
                The Account page contains a new section titled <strong>Delete My Account</strong>. In this
                section, a learner may click the <strong>Delete My Account</strong> button and enter
                their password to confirm their request.  Subsequently, all of the learner’s
                browser sessions are logged off, and they become locked out of their account.</paragraph>
            <paragraph>An informational email is immediately sent to the learner to confirm the
                deletion of their account. After this email is sent, the learner has a limited
                amount of time (defined by the <literal>--cool_off_days</literal> argument described in
                <reference internal="True" refuri="driver_setup#driver-setup"><inline classes="std std-ref">Setting Up the User Retirement Driver Scripts</inline></reference>) to contact the site administrators and rescind their
                request.</paragraph>
            <paragraph>At this point, the learner’s account has been deactivated, but <emphasis>not</emphasis> retired.
                An entry in the <literal>UserRetirementStatus</literal> table is added, and their state set to
                <literal>PENDING</literal>.</paragraph>
            <paragraph>By default, the <strong>Delete My Account</strong> section is visible and the button is
                enabled, allowing account deletions to queue up.  The
                <literal>ENABLE_ACCOUNT_DELETION</literal> feature in django settings toggles the visibility
                of this section.  See <reference internal="True" refuri="service_setup#django-settings"><inline classes="std std-ref">Django Settings</inline></reference>.</paragraph>
            <section ids="third-party-auth" names="third\ party\ auth">
                <title>Third Party Auth</title>
                <paragraph>Learners who registered using social authentication must first unlink their
                    LMS account from their third-party account. For those learners, the <strong>Delete
                        My Account</strong> button will be disabled until they do so; meanwhile, they will be
                    instructed to follow the procedure in this help center article: <reference name="How do I link or unlink my edX account to a social media account?" refuri="https://support.edx.org/hc/en-us/articles/207206067">How do I link
                        or unlink my edX account to a social media
                        account?</reference><target ids="how-do-i-link-or-unlink-my-edx-account-to-a-social-media-account" names="how\ do\ i\ link\ or\ unlink\ my\ edx\ account\ to\ a\ social\ media\ account?" refuri="https://support.edx.org/hc/en-us/articles/207206067"></target>.</paragraph>
            </section>
        </section>
    </section>
</document>
